---
title: Practical Session no. 2
description: training in the manipulation of R
required_packages: ggplot2, hrbrthemes
author: Grace Catapang
date: 2024-09-19
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Practical Session 2

```{r packages}
library("ggplot2")
library("hrbrthemes")
```

## Exercise 1: Open data file

```{r data file}
somlit <- read.table("2022_SOMLIT.txt", header=TRUE)
somlit
```

-   What are the variables?

```{r data info}
variables <- names(somlit)
variables
```

-   How many observations are there in the database?

```{r number of observations}
observations <- dim(somlit)
observations[1]
```

## Exercise 2: time series analysis of chlorophyll-a concentration CHLA

-   Compute the basic descriptive statistics of CHLA

```{r descriptive stat}
attach(somlit) 
mean(CHLA)
median(CHLA)
sd(CHLA)
```

-   Generate the histogram of the relative frequency of CHLA (see Fig1) \*\* The relative frequency is the count over the total number of count

```{r histogram}
hist(CHLA)
#this is not the histogram we want. needs to be relative frequency
Hist <- hist (CHLA, plot =FALSE)
Hist #see the data within the histogram. ir shows the count and breaks(x-axis) that we need to compute relative frequency

# relative frequencies of CHLA is the count divided by the sum of the counts, this is the y value
(barplot(Hist$counts/sum(Hist$counts), 
  ylab="Relative frequency",
  names.arg=Hist$mids, xlab=expression(paste("CHLA(",mu,"g/L)")),
  main="Histogram of the relative frequency of CHLA"))
```

* Generate the time series of CHLA (see Fig2)  
```{r time series}

#fix the date and time data type and formatting
date <- as.Date(DATE, format = "%d/%m/%Y")
#now the Date is no longer a character

#alternative
plot(date, CHLA, type = "b",
     ylab = expression(paste("CHLA (", mu, "g/L)")),
     xlab = "Date",
     main = "Time Series of CHLA")
```

## Other exercise
###Exercise 6
Figure 6.1
```{r binomial distribution}
coul <- c("black", "red","green","blue")
fd <- dbinom(c(0:5), 5, 0.5)
{plot(fd~c(0:5), xlim=c(0,20), ylim=c(0,.40), type="p", ylab=" ", xlab=" ", pch=15,
     cex=2, lwd=3, col=coul[1], cex.axis=2)}

fd <- dbinom(c(0:10), 10, 0.50)
{points(fd~c(0:10), xlim=c(0,10), ylim=c(0,.40), type="p", ylab=" ", xlab=" ", pch=16,
       cex=2, lwd=3, col=coul[2], new=TRUE)}

fd <- dbinom(c(0:20), 20, 0.50)
{points(fd~c(0:20), xlim=c(0,20), ylim=c(0,.40), type="p", ylab=" ", xlab=" ", pch=17,
       cex=2, lwd=3, col=coul[3], new=TRUE)}

{legtxt <- c(expression(paste(italic(n), " = 5", sep="")),
            expression(paste(italic(n), " = 10", sep="")),
            expression(paste(italic(n), " = 20", sep="")))}

{legend("topright", legtxt, title=expression(paste(italic(p), " = 0.5", sep="")),
       pch=c(15,16,17), col=c(coul[1], coul[2], coul[3]), cex=2, bg="white", inset=0.075)}
```

###Exercise 7
Packets of seeds of Zostera are commercially available. In a packet there are 15 seeds and each seed gives at most a foot of Zostera. Seagrasses have a probability of germination equal 
to 0.85. 

6.1. What is the minimum number of packets that a PhD student must purchase to obtain at least 200 Zostera foot with a probability greater than or equal to 0.95? 
* Need at least 246 Zostera seeds
* Need at least 17 packets

6.2. The Phd student has 100 euros to purchase the seeds. A packet is sold 4.50 euros. How many feet should he expect to get?
* 

Given:
p=0.85
P(X>=200) =0.95
P(X<200)=1-0.95=0.05
F(X=x)=P(X<x)=0.05


```{r exercise 7}
?dbinom
plot(200:250,qbinom(0.05,200:250,0.85))
#add a line to plot
abline(h=200)
abline(v=246)
246/15
100/4.5
22*15
plot(cumsum(fd~c(0:330)))
```
